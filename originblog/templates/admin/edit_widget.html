{% extends 'admin/base.html' %}
{% from 'bootstrap/form.html' import render_field %}

{% block custom_head %}
    <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
{% endblock %}

{% block title %}Edit Widget{% endblock title %}

{% block main %}
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Edit Widget</h1>
    </div>
    <form action="{{ url_for('admin.widget', pk=pk) }}" method="post">
        {{ form.csrf_token }}
        {{ render_field(form.title) }}
        {{ render_field(form.priority) }}
        {{ render_field(form.content_type) }}
        {{ form.content.label }}
        {{ form.content(id="easymde") }}
        {% if form.content.errors %}
            {% for message in form.content.errors %}
            <small class="error">{{ message }}</small><br>
            {% endfor %}
        {% endif %}
        {{ form.submit(class_="btn btn-primary") }}
    </form>
    <br>
{% endblock %}

{% block scripts %}
    <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
    <script>
    let easyMDE = new EasyMDE({element: $('#easymde')[0]});
    $('#submit').click(function(){
      $('#easymde').text(easyMDE.value());
    });
    </script>
{% endblock %}